# Railway/Nixpacks Konfiguration - Monorepo (Frontend + Backend)
# WICHTIG: FÃ¼r Railway sollten separate Services mit Root Directory verwendet werden!
# Frontend Service: Root Directory = "frontend"
# Backend Service: Root Directory = "backend"

[phases.setup]
nixPkgs = ["python311", "python311Packages.pip", "openjdk17", "nodejs_20"]

[phases.install]
cmds = [
  "pip install --no-cache-dir -r backend/backend_requirements.txt",
  "cd frontend && npm ci"
]

[phases.build]
cmds = ["cd frontend && npm run build"]

[start]
cmd = "npm run preview -- --host 0.0.0.0 --port $PORT"

[variables]
NODE_ENV = "production"
