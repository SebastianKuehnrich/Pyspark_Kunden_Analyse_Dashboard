# Railway/Nixpacks Konfiguration - Monorepo (Frontend + Backend)
# WICHTIG: FÃ¼r Railway sollten separate Services mit Root Directory verwendet werden!
# Frontend Service: Root Directory = "frontend" (nutzt frontend/nixpacks.toml)
# Backend Service: Eigenes Repository (nutzt backend/nixpacks.toml)

[phases.setup]
nixPkgs = ["python311", "python311Packages.pip", "openjdk17", "nodejs_20"]

[phases.install]
cmds = [
  "pip install --no-cache-dir -r backend/backend_requirements.txt --break-system-packages",
  "cd frontend && npm ci"
]

[phases.build]
cmds = ["cd frontend && npm run build"]

[start]
cmd = "cd frontend && npm run preview -- --host 0.0.0.0 --port $PORT"

[variables]
NODE_ENV = "production"
